<!doctype html><html>
<head>
<title> 数字的中文读法 &#183; wanglun </title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<meta name=generator content="Hugo 0.89.4">
<link rel=stylesheet href=https://wanglun.org/css/vec.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=/favicon.ico>
<link href rel=alternate type=application/rss+xml title=wanglun>
</head>
<body>
<header>
<nav>
<ul>
<li class=pull-left>
<a href=https://wanglun.org/>/home/wanglun</a>
</li>
<li class="pull-left current">
<a href=/post>~/post</a>
</li>
<li class=pull-right><a href><i class="fas fa-rss"></i></a></li>
</ul>
</nav>
</header>
<div class="content toc">
<nav id=TableOfContents>
<ul>
<li><a href=#题目>题目</a></li>
<li><a href=#动手实现>动手实现</a></li>
</ul>
</nav>
<section class=post>
<h1 class=post-title><a href=https://wanglun.org/post/number-in-chinese/>数字的中文读法</a></h1>
<span class=post-date>Jun 9, 2019 </span>
<div class="post-content markdown-body">
<h2 id=题目>题目</h2>
<p>本次的编码练习题是“数字的中文读法”，需要完成数字与其中文读法之间的相互转换，例如：</p>
<ul>
<li>123 -> 一百二十三</li>
<li>200 -> 二百</li>
<li>201 -> 二百零一</li>
<li>2001 -> 二千零一</li>
<li>200000 -> 二十万</li>
<li>210000 -> 二十一万</li>
<li>210500 -> 二十一万零五百</li>
<li>123410500 -> 一亿二千三百四十一万零五百</li>
<li>2023400500 -> 二十亿二千三百四十万零五百</li>
<li>1002023400500 -> 一万零二十亿二千三百四十万零五百</li>
</ul>
<h2 id=动手实现>动手实现</h2>
<p>重点是分析中文读法的规律，尽量多写一些测试用例，以覆盖到不同的情况。示例代码如下：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unordered_map&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;cassert&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#75715e>// 可以处理最长13位的数字
</span><span style=color:#75715e></span>std<span style=color:#f92672>::</span>string say_number_in_chinese_v1(<span style=color:#66d9ef>long</span> num) {
  <span style=color:#75715e>// 单位映射
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string units_map[] <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;十&#34;</span>, <span style=color:#e6db74>&#34;百&#34;</span>, <span style=color:#e6db74>&#34;千&#34;</span>, <span style=color:#e6db74>&#34;万&#34;</span>, <span style=color:#e6db74>&#34;十&#34;</span>,
    <span style=color:#e6db74>&#34;百&#34;</span>, <span style=color:#e6db74>&#34;千&#34;</span>, <span style=color:#e6db74>&#34;亿&#34;</span>, <span style=color:#e6db74>&#34;十&#34;</span>, <span style=color:#e6db74>&#34;百&#34;</span>, <span style=color:#e6db74>&#34;千&#34;</span>, <span style=color:#e6db74>&#34;万&#34;</span>};
  <span style=color:#75715e>// 数字映射
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string digits_map[] <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;零&#34;</span>, <span style=color:#e6db74>&#34;一&#34;</span>, <span style=color:#e6db74>&#34;二&#34;</span>, <span style=color:#e6db74>&#34;三&#34;</span>, <span style=color:#e6db74>&#34;四&#34;</span>, <span style=color:#e6db74>&#34;五&#34;</span>,
    <span style=color:#e6db74>&#34;六&#34;</span>, <span style=color:#e6db74>&#34;七&#34;</span>, <span style=color:#e6db74>&#34;八&#34;</span>, <span style=color:#e6db74>&#34;九&#34;</span>};

  <span style=color:#75715e>// 0直接返回
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (num <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
    <span style=color:#66d9ef>return</span> digits_map[<span style=color:#ae81ff>0</span>];
  }

  std<span style=color:#f92672>::</span>string ret;
  <span style=color:#75715e>// 检测连续的0
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>bool</span> zero_flag <span style=color:#f92672>=</span> false;
  <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
  <span style=color:#66d9ef>while</span> (num) {
    <span style=color:#66d9ef>int</span> digit <span style=color:#f92672>=</span> num <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span>;
    <span style=color:#66d9ef>if</span> (digit) {
      ret <span style=color:#f92672>=</span> units_map[i] <span style=color:#f92672>+</span> ret;
      ret <span style=color:#f92672>=</span> digits_map[digit] <span style=color:#f92672>+</span> ret;
      zero_flag <span style=color:#f92672>=</span> false;
    } <span style=color:#66d9ef>else</span> {
      <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
        ret <span style=color:#f92672>=</span> units_map[i] <span style=color:#f92672>+</span> ret;
      } <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>if</span> (<span style=color:#f92672>!</span>zero_flag) {
        ret <span style=color:#f92672>=</span> digits_map[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> ret;
      }
      zero_flag <span style=color:#f92672>=</span> true;
    }

    <span style=color:#f92672>++</span>i;
    num <span style=color:#f92672>=</span> num <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>;
  }

  <span style=color:#66d9ef>return</span> ret;
}

<span style=color:#75715e>// 四位数字作为一组进行处理
</span><span style=color:#75715e>// 与v1相比，可以处理任意位数的数字
</span><span style=color:#75715e></span>std<span style=color:#f92672>::</span>string say_number_in_chinese_v2(<span style=color:#66d9ef>long</span> num) {
  <span style=color:#75715e>// 单位映射
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string units_map[] <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;十&#34;</span>, <span style=color:#e6db74>&#34;百&#34;</span>, <span style=color:#e6db74>&#34;千&#34;</span>};
  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> units_count <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string unit_wan <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;万&#34;</span>;
  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> unit_wan_index <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string unit_yi <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;亿&#34;</span>;
  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> unit_yi_index <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>;
  <span style=color:#75715e>// 数字映射
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string digits_map[] <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;零&#34;</span>, <span style=color:#e6db74>&#34;一&#34;</span>, <span style=color:#e6db74>&#34;二&#34;</span>, <span style=color:#e6db74>&#34;三&#34;</span>, <span style=color:#e6db74>&#34;四&#34;</span>, <span style=color:#e6db74>&#34;五&#34;</span>,
    <span style=color:#e6db74>&#34;六&#34;</span>, <span style=color:#e6db74>&#34;七&#34;</span>, <span style=color:#e6db74>&#34;八&#34;</span>, <span style=color:#e6db74>&#34;九&#34;</span>};

  <span style=color:#75715e>// 0直接返回
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (num <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
    <span style=color:#66d9ef>return</span> digits_map[<span style=color:#ae81ff>0</span>];
  }

  std<span style=color:#f92672>::</span>string ret;
  <span style=color:#75715e>// 检测连续的0
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>bool</span> zero_flag <span style=color:#f92672>=</span> false;
  <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
  <span style=color:#66d9ef>while</span> (num) {
    <span style=color:#66d9ef>int</span> digit <span style=color:#f92672>=</span> num <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span>;
    <span style=color:#75715e>// 处理单位
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>&amp;&amp;</span> i <span style=color:#f92672>%</span> unit_yi_index <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
      ret <span style=color:#f92672>=</span> unit_yi <span style=color:#f92672>+</span> ret;
    } <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>if</span> (i <span style=color:#f92672>&amp;&amp;</span> i <span style=color:#f92672>%</span> unit_wan_index <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
      ret <span style=color:#f92672>=</span> unit_wan <span style=color:#f92672>+</span> ret;
    } <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>if</span> (digit) {
      ret <span style=color:#f92672>=</span> units_map[i <span style=color:#f92672>%</span> units_count] <span style=color:#f92672>+</span> ret;
    }
    <span style=color:#75715e>// 处理数字
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (digit) {
      ret <span style=color:#f92672>=</span> digits_map[digit] <span style=color:#f92672>+</span> ret;
      zero_flag <span style=color:#f92672>=</span> false;
    } <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>if</span> (<span style=color:#f92672>!</span>zero_flag) {
      <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>%</span> units_count <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>) {
        ret <span style=color:#f92672>=</span> digits_map[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> ret;
      }
      zero_flag <span style=color:#f92672>=</span> true;
    }

    <span style=color:#f92672>++</span>i;
    num <span style=color:#f92672>=</span> num <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>;
  }

  <span style=color:#66d9ef>return</span> ret;
}

<span style=color:#75715e>// 将中文读法转换回数字
</span><span style=color:#75715e>// return -1 when error happends
</span><span style=color:#75715e></span><span style=color:#66d9ef>long</span> <span style=color:#a6e22e>translate_number_in_chinese</span>(<span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>string<span style=color:#f92672>&amp;</span> num) {
  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>unordered_map<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>string, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> units_map{
    {<span style=color:#e6db74>&#34;十&#34;</span>, <span style=color:#ae81ff>10</span>},
    {<span style=color:#e6db74>&#34;百&#34;</span>, <span style=color:#ae81ff>100</span>},
    {<span style=color:#e6db74>&#34;千&#34;</span>, <span style=color:#ae81ff>1000</span>},
    {<span style=color:#e6db74>&#34;万&#34;</span>, <span style=color:#ae81ff>10000</span>},
    {<span style=color:#e6db74>&#34;亿&#34;</span>, <span style=color:#ae81ff>100000000</span>}
  };
  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>const</span> std<span style=color:#f92672>::</span>unordered_map<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>string, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> digits_map{
    {<span style=color:#e6db74>&#34;零&#34;</span>, <span style=color:#ae81ff>0</span>},
    {<span style=color:#e6db74>&#34;一&#34;</span>, <span style=color:#ae81ff>1</span>},
    {<span style=color:#e6db74>&#34;二&#34;</span>, <span style=color:#ae81ff>2</span>},
    {<span style=color:#e6db74>&#34;三&#34;</span>, <span style=color:#ae81ff>3</span>},
    {<span style=color:#e6db74>&#34;四&#34;</span>, <span style=color:#ae81ff>4</span>},
    {<span style=color:#e6db74>&#34;五&#34;</span>, <span style=color:#ae81ff>5</span>},
    {<span style=color:#e6db74>&#34;六&#34;</span>, <span style=color:#ae81ff>6</span>},
    {<span style=color:#e6db74>&#34;七&#34;</span>, <span style=color:#ae81ff>7</span>},
    {<span style=color:#e6db74>&#34;八&#34;</span>, <span style=color:#ae81ff>8</span>},
    {<span style=color:#e6db74>&#34;九&#34;</span>, <span style=color:#ae81ff>9</span>}
  };
  <span style=color:#75715e>// 相关汉字在utf8中都是占3个字节
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> size_per_word <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;

  <span style=color:#66d9ef>if</span> (num.size() <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> num.size() <span style=color:#f92672>%</span> size_per_word <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>) {
    <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
  }

  <span style=color:#66d9ef>long</span> ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
  <span style=color:#66d9ef>int</span> sub_num <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 每四位作为一个分组，对应的数字
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>int</span> digit <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> num.size(); i <span style=color:#f92672>+=</span> size_per_word) {
    std<span style=color:#f92672>::</span>string word <span style=color:#f92672>=</span> num.substr(i, size_per_word);
    <span style=color:#66d9ef>auto</span> unit_it <span style=color:#f92672>=</span> units_map.find(word);
    <span style=color:#66d9ef>if</span> (unit_it <span style=color:#f92672>!=</span> units_map.end()) {
      <span style=color:#66d9ef>if</span> (unit_it<span style=color:#f92672>-&gt;</span>first <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;万&#34;</span>) {
        sub_num <span style=color:#f92672>+=</span> digit;
        ret <span style=color:#f92672>+=</span> sub_num <span style=color:#f92672>*</span> unit_it<span style=color:#f92672>-&gt;</span>second;
        sub_num <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
        digit <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
      } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (unit_it<span style=color:#f92672>-&gt;</span>first <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;亿&#34;</span>) {
        ret <span style=color:#f92672>+=</span> sub_num <span style=color:#f92672>+</span> digit;
        ret <span style=color:#f92672>*=</span> unit_it<span style=color:#f92672>-&gt;</span>second;
        sub_num <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
        digit <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
      } <span style=color:#66d9ef>else</span> {
        sub_num <span style=color:#f92672>+=</span> digit <span style=color:#f92672>*</span> unit_it<span style=color:#f92672>-&gt;</span>second;
        digit <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
      }
    } <span style=color:#66d9ef>else</span> {
      <span style=color:#66d9ef>auto</span> digit_it <span style=color:#f92672>=</span> digits_map.find(word);
      <span style=color:#66d9ef>if</span> (digit_it <span style=color:#f92672>==</span> digits_map.end()) {
        <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
      }
      digit <span style=color:#f92672>=</span> digit_it<span style=color:#f92672>-&gt;</span>second;
    }
  }
  ret <span style=color:#f92672>+=</span> sub_num <span style=color:#f92672>+</span> digit;

  <span style=color:#66d9ef>return</span> ret;
}

<span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
  std<span style=color:#f92672>::</span>unordered_map<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>long</span>, std<span style=color:#f92672>::</span>string<span style=color:#f92672>&gt;</span> cases{
    {<span style=color:#ae81ff>123</span>, <span style=color:#e6db74>&#34;一百二十三&#34;</span>},
    {<span style=color:#ae81ff>200</span>, <span style=color:#e6db74>&#34;二百&#34;</span>},
    {<span style=color:#ae81ff>201</span>, <span style=color:#e6db74>&#34;二百零一&#34;</span>},
    {<span style=color:#ae81ff>2001</span>, <span style=color:#e6db74>&#34;二千零一&#34;</span>},
    {<span style=color:#ae81ff>200000</span>, <span style=color:#e6db74>&#34;二十万&#34;</span>},
    {<span style=color:#ae81ff>210000</span>, <span style=color:#e6db74>&#34;二十一万&#34;</span>},
    {<span style=color:#ae81ff>210500</span>, <span style=color:#e6db74>&#34;二十一万零五百&#34;</span>},
    {<span style=color:#ae81ff>123410500</span>, <span style=color:#e6db74>&#34;一亿二千三百四十一万零五百&#34;</span>},
    {<span style=color:#ae81ff>2023400500</span>, <span style=color:#e6db74>&#34;二十亿二千三百四十万零五百&#34;</span>},
    {<span style=color:#ae81ff>1002023400500</span>, <span style=color:#e6db74>&#34;一万零二十亿二千三百四十万零五百&#34;</span>}
  };

  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span> i : cases) {
    assert(say_number_in_chinese_v1(i.first) <span style=color:#f92672>==</span> i.second);
    assert(say_number_in_chinese_v2(i.first) <span style=color:#f92672>==</span> i.second);
  }

  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span> i : cases) {
    assert(translate_number_in_chinese(i.second) <span style=color:#f92672>==</span> i.first);
  }
}
</code></pre></div>
</div>
</section>
<section class="pagination clearfix">
<a class="btn previous" href=https://wanglun.org/post/database-comparison/> 主流数据库对比及应用场景举例 </a>
<a class="btn next" href=https://wanglun.org/post/distributed-request-rate-limiting/> 大规模检索系统的分布式限流 </a>
</section>
</div>
<footer>
<div class=footer-info>
<p>
<a href="mailto:me@wanglun.org?subject="><i class="far fa-envelope"></i> me@wanglun.org </a>
{
<a href=https://gohugo.io/ title="Hugo :: A fast and modern static website engine">Hugo 0.89.4</a>,
<a href=https://github.com/IvanChou/yii.im title=vec>Vec</a>
}
{<a href=http://creativecommons.org/licenses/by-nc-nd/3.0/ title="CC BY-NC-ND 3.0">CC BY-NC-ND 3.0</a>}
</p>
</div>
</footer>
<script src=https://wanglun.org/js/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script>
<script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'),ga('create','UA-30344688-1','auto'),ga('send','pageview')</script>
</body>
</html>